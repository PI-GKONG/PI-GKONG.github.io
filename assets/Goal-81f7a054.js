import{u as j,r as i,w as O,b as d,c,d as e,t as m,h as p,s as _,A as G,F as b,g as k,m as M,x as P,v as A,n as D,z as w}from"./index-a569ccc7.js";const B="/assets/thumbs-up-442a78c3.svg";const L={class:"bg-slate-100 w-4/5 h-[70%] rounded-md p-5 text-black"},V=e("h1",{class:"text-center text-xl font-black"}," 목표 추가 ",-1),$={class:"overflow-y-scroll h-5/6",style:{"overflow-y":"auto"}},z={class:"mb-4 mt-5 border-t-2 border-solid"},I={class:"font-black text-center"},N=e("div",{class:"items-center font-black text-left mb-3"}," 목표 유형 ",-1),U={class:"flex justify-around items-center"},F=["value"],J={key:0,class:"w-[4rem] h-[4rem] rounded-full bg-[#07E092] items-center flex"},q=["src"],H=e("div",{class:"items-center font-black text-left mb-3"}," 목표 내용 ",-1),K={class:"flex justify-center"},Q=["placeholder"],R={class:"space-y-2.5 w-full h-full"},W=e("p",{class:"font-bold text-3xl"},"Score",-1),X={class:"container rounded-full"},Y={width:"230",height:"230",class:"svg"},Z=e("circle",{r:"90",cx:"115",cy:"115",class:"border bg-gray-100"},null,-1),ee={x:"50%",y:"47%","dominant-baseline":"middle","text-anchor":"middle",class:"font-bold text-5xl"},te=e("text",{x:"50%",y:"60%","dominant-baseline":"middle","text-anchor":"middle",class:"font-bold text-2xl"}," /100 ",-1),se=e("p",{class:"font-bold text-3xl"},"Daily Goal",-1),oe={class:"space-y-2.5 overflow-y-scroll max-h-[270px]",style:{"overflow-y":"auto"}},le={class:"flex items-center"},ae={class:"w-[3rem] h-[3rem] rounded-full bg-[#07E092] items-center flex shadow-2xl"},ne=["src"],de={class:"text-base font-black ml-2"},ce={class:"flex justify-end ml-auto"},re=["onClick"],ie=["onClick"],ue=e("img",{src:B,class:"w-[2rem] h-[2rem] m-auto thumbs-on"},null,-1),he=[ue],ge=["onClick"],x=565.2,fe={__name:"Goal",setup(me){const a=j();a.currentPage=5;const u=i(!1),n={description:i(""),goalType:i(0)},h=[{id:0,name:"운동",img:"../src/assets/img/goal/walk.svg",hold:"5000보 걷기"},{id:1,name:"약물 섭취",img:"../src/assets/img/goal/pills.svg",hold:"저녁약 섭취"},{id:2,name:"식사",img:"../src/assets/img/goal/rice.svg",hold:"아침 밥 섭취"},{id:3,name:"물 섭취",img:"../src/assets/img/goal/water.svg",hold:"물 2L 섭취"},{id:4,name:"기타",img:"../src/assets/img/goal/etc.svg",hold:"병원 방문"}],f=()=>{u.value=!u.value},r={dashOffset:i(565.2),score:i(0)},T=()=>{const s=document.getElementById("goalProgress");s&&(s.style.transition="stroke-dashoffset 0.5s ease-in-out",s.style.strokeDashoffset=`${r.dashOffset.value}`)},C=()=>{console.log("store.goalData.details: ",a.goalData.details);let s,o,t,l;a.goalData.details?(s=a.goalData.details.filter(v=>v.archievement_status===!0).length,o=a.goalData.details.length,t=100/o*s,r.score.value=Math.min(t,100),l=x-s*(x/o),r.dashOffset.value=Math.max(l,0)):r.dashOffset.value=x,T()},E=()=>{let s={},o=a.selectDate,t=1;s.goal_description=n.description.value,s.archievement_status=!1,s.date=o,s.user_id=t,s.goal_type=n.goalType.value,console.log(s),fetch("http://210.91.210.243:8509/goal",{method:"POST",headers:{"Content-Type":"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then(v=>{console.log(v)}),n.goalType.value=0,n.description.value="",f(),setTimeout(()=>{g(1)},100)},g=s=>{const o=a.selectDate;let t="http://210.91.210.243:8509/goal?user_id="+s+"&date="+o;console.log(t);try{fetch(t,{method:"GET"}).then(l=>l.json()).then(l=>{console.log("data: ",l),a.goalData={goal:{score:0},details:""},l&&(console.log("store :",a.goalData),a.goalData.goal=l.goal,a.goalData.details=l.goal_details),C()})}catch(l){console.error("에러 :",l)}},y=s=>{try{let o="http://210.91.210.243:8509/goal?goal_detail_id="+s;console.log(o),fetch(o,{method:"PUT"}),setTimeout(()=>{g(1)},100)}catch(o){console.error("에러 :",o)}},S=s=>{let t="http://210.91.210.243:8509/goal?goal_detail_id="+s;confirm("삭제하시겠습니까?")&&(fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}}),setTimeout(()=>{g(1)},100))};return O(()=>{a.selectDate!=""&&g(1)}),(s,o)=>(d(),c(b,null,[e("div",{id:"goalModal",class:A(["modal-overlay",{"modal-on":u.value}]),style:D({visibility:u.value?"visible":"hidden"})},[e("div",L,[e("div",{class:"flex justify-end"},[e("button",{onClick:f,class:"text-3xl font-black"},"×")]),V,e("div",$,[e("div",z,[e("h1",I,m(p(a).selectDate),1),e("div",null,[N,e("div",U,[_(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>n.goalType.value=t),class:"w-[6rem] h-[2rem] text-center"},[(d(),c(b,null,k(h,t=>e("option",{class:"text-center",value:t.id},m(t.name),9,F)),64))],512),[[G,n.goalType.value]]),n.goalType.value!==null&&n.goalType.value!==void 0?(d(),c("div",J,[e("img",{class:"m-auto w-[2rem] h-[2rem]",src:h[n.goalType.value].img},null,8,q)])):M("",!0)])]),e("div",null,[H,e("span",K,[_(e("input",{id:"feedbackTitle",type:"text",class:"border-solid border-b-4 rounded-md font-medium text-center w-4/5 ml-2",placeholder:h[n.goalType.value].hold,"onUpdate:modelValue":o[1]||(o[1]=t=>n.description.value=t)},null,8,Q),[[P,n.description.value]])])])]),e("div",{class:"text-right"},[e("button",{class:"mr-2 px-4 py-0.5 font-bold text-s rounded-md border-2 border-black text-black bg-white",onClick:E}," 저장 ")])])])],6),e("div",R,[W,e("div",X,[(d(),c("svg",Y,[Z,e("circle",{id:"goalProgress",r:"90",cx:"115",cy:"115",class:"progress rounded-xl",style:D({strokeDasharray:565.2,strokeDashoffset:r.dashOffset.value,animation:"all 2s ease-in-out forwards"})},null,4),e("text",ee,m(p(a).goalData.goal.score),1),te]))]),e("div",{class:"flex"},[se,e("button",{class:"ml-auto border-solid border-2 border-[#c8c8c8] rounded-md px-3 font-bold",onClick:f}," 목표 추가 ")]),e("div",oe,[(d(!0),c(b,null,k(p(a).goalData.details,t=>(d(),c("div",{key:t.id,class:"bg-white rounded-2xl flex justify-between p-4 text-black"},[e("div",le,[e("div",ae,[e("img",{src:h[t.goal_type].img,class:"w-[1.5rem] h-[1.5rem] m-auto"},null,8,ne)]),e("span",de,m(t.goal_description),1)]),e("div",ce,[_(e("button",{onClick:l=>y(t.goal_detail_id),class:"w-[3rem] h-[3rem] border-solid border-4 border-[#CDCDCD] rounded-full"},null,8,re),[[w,t.archievement_status==!1]]),_(e("button",{onClick:l=>y(t.goal_detail_id),class:"w-[3rem] h-[3rem] border-solid border-4 border-[#07E092] rounded-full text-center"},he,8,ie),[[w,t.archievement_status==!0]])]),e("button",{onClick:l=>S(t.goal_detail_id),class:"flex font-black text-md items-start"},"×",8,ge)]))),128))])])],64))}};export{fe as default};
